<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>ngCookbook</title>
	<meta http-equiv="Content-Language" content="en"/>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
	<meta name="google" value="notranslate"/>
	<meta name="apple-mobile-web-app-capable" content="yes"/>
	<meta name="apple-mobile-web-app-status-bar-style" content="yes"/>
	<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimal-ui"/>

	<!-- Early loader -->
	<link rel="stylesheet" href="/dist/loader.css"/>
	<script src="/dist/loader.js"></script>

	<!-- jQuery -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-rc1/jquery.min.js"></script>

	<!-- Bootstrap -->
	<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha/css/bootstrap.css" rel="stylesheet" type="text/css"/>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha/js/bootstrap.min.js"></script>

	<!-- FontAwesome -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css"/>
	
	<!-- Angular -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.6/angular.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.6/angular-resource.js"></script>

	<!-- Angular loader component -->
	<script src="/dist/ng-loader.js"></script>
</head>
<style>
a { cursor: pointer }
li.list-group-item { padding: 0 }
li.list-group-item > a { padding: 10px; display: block; text-decoration: none }
li.list-group-item:hover { background: #B8DFEA }
</style>

<script>
var app = angular.module("app", [
	'ngResource'
]);

app.factory('Reddit', function($resource) {
	return $resource('https://www.reddit.com', {}, {
		subreddit: {url: 'https://www.reddit.com/r/:subreddit.json', method: 'GET'},
	});
});

app.controller('redditController', function($scope, $window, $http, Reddit) {
	$scope.posts = [];

	// Allow Angular to communicate cross domain (not normally needed)
	$http.defaults.useXDomain = true;

	Reddit.subreddit({subreddit: 'australia'}).$promise
		.then(function(listings) {
			// Titles exist within listings.data.children (and for annoying reasons each payload is packed into .data)
			$scope.posts = listings.data.children.map(function(post) {
				return post.data;
			});
		})
		.catch(function(e) {
			console.error('An error has occured!', e);
		});

	$scope.selectPost = function(post) {
		$window.location = 'https://www.reddit.com' + post.permalink;
	};
});
</script>

<body ng-app="app">
	<div class="container">
		<div class="alert alert-info">
			<a data-dismiss="alert" class="pull-right"><i class="fa fa-times"></i></a>
			<p>An extremely simple example of the MFDC loader</p>
			<p>
				The loader has three parts:
				<ul>
					<li><strong>The CSS loader</strong> - an extremely dumb component which loads the base resources and injects the loader onto the page</li>
					<li><strong>The JS loader</strong> - pure JS (no jQuery) controller for the loader</li>
					<li><strong>Angular $loader (optional)</strong> - higher level controller via Angular</li>
				</ul>
			</p>
			<p>As this demo is all about loading, its best viewed with network throttling turned on.</p>
		</div>
	</div>

	<div class="container">
		<div class="row">
			<div class="col-md-6">
				<div class="card">
					<div class="card-header">Loading controls</div>
					<ul class="list-group list-group-flush">
						<li class="list-group-item"><a ng-click="loaderStart('debug1')">loader.start("debug1")</a></li>
						<li class="list-group-item"><a ng-click="loaderStop('debug1')">loader.stop("debug1")</a></li>
						<li class="list-group-item"><a ng-click="loaderStartBackground('debug2')">loader.startBackground("debug2")</a></li>
						<li class="list-group-item"><a ng-click="loaderStop('debug2')">loader.stop("debug2")</a></li>
						<li class="list-group-item"><a ng-click="loaderStart('debug3', false)">loader.start("debug3", false)</a></li>
						<li class="list-group-item"><a ng-click="loaderStop('debug3')">loader.stop("debug3")</a></li>
					</ul>
				</div>
			</div>
			<div class="col-md-6">
				<div class="card">
					<div class="card-header">Loading status</div>
					<div class="card-block text-xs-center">
						<div class="visible-loading bg-info">Page loading</div>
						<div class="visible-loading bg-info">Page background loading</div>
						<div class="visible-loading bg-info">Page foreground loading</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<hr/>

	<div ng-controller="redditController" class="container hidden-loading">
		<div class="row">
			<table class="table table-bordered table-striped">
				<thead>
					<th>Score</th>
					<th>Title</th>
				</thead>
				<tbody>
					<tr ng-repeat="post in posts">
						<td><a ng-click="selectPost(post)">{{post.score}}</a></td>
						<td><a ng-click="selectPost(post)">{{post.title}}</a></td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>
</body>
